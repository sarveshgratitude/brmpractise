this is written for the newmsg branch